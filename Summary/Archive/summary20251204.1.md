# Session Summary - 2025-12-04 Session 1

## Objective
Discuss process mining from telemetry and property-based testing. Create ADRs for causal/process graph learning from both runtime traces and development artifacts.

---

## Prior Session Summary (December 3rd)

| Session | Focus | Key Outcome |
|---------|-------|-------------|
| 1 | OpenTelemetry RL Triplets | ADR 003 created, flexible triplet schema designed |

**Key Decisions from Dec 3:**
- Created ADR 003: OpenTelemetry RL Triplet Instrumentation
- Designed flexible triplet schema: `(state: dict, action: dict, reward: float | None)`
- Reward range: 0.0 to 1.0 continuous
- Sequence scoping: agent, pipeline, or session level
- Deferred reward assignment pattern

---

## Prior Session Summary (December 2nd - 11 Sessions)

| Session | Focus | Key Outcome |
|---------|-------|-------------|
| 1 | Test coverage | 73%→78%, ADR 002 |
| 2 | PR merges | Merged 3 PRs, started web UI integration |
| 3 | Pre-commit | Added linting hooks |
| 4 | E2E tests | 24/24 passing, telemetry DB |
| 5-7 | Web UI | HITL, costs, sparklines, budget, traceability, dark mode, diff view |
| 8-9 | Bug fixes | Unicode fix, CI/CD lint fixes |
| 10 | Features | What-If simulator, +40 tests, coverage 74% |
| 11 | Docs | README update, test suite validation |

**Current State:**
- Test coverage: 74% (target: 80%)
- Web UI: 12/13 tasks complete
- All CI/CD pipelines passing
- ADR 003 awaiting implementation

---

## Today's Discussion Topics

### 1. Process Mining from Telemetry

Process mining applies data mining to event logs to discover, monitor, and improve processes. Relevant to this project because:

- **Existing data sources**:
  - SQLite telemetry (`asp_telemetry.db`) with `agent_cost_vector` and `defect_log`
  - Langfuse traces for LLM calls
  - Planned OpenTelemetry RL triplets

- **Potential applications**:
  - Discover actual agent workflow patterns vs designed patterns
  - Identify bottlenecks in TSP orchestration
  - Conformance checking: do agents follow expected process models?
  - Performance analysis: where do delays/costs accumulate?

### 2. Property-Based Testing

Property-based testing (PBT) generates test cases from specifications rather than manually writing examples. Relevant to this project because:

- **Current testing**: pytest with unit/integration tests at 74% coverage
- **PBT tools for Python**: Hypothesis is the standard library
- **Good candidates for PBT in this codebase**:
  - Agent input/output validation (arbitrary task descriptions)
  - Data layer functions (simulate_timeline, cost calculations)
  - Schema validation (triplet schemas, artifact schemas)
  - Serialization round-trips (JSON ↔ dataclass)

---

## Completed Work

### ADR 004: Process Graph Learning from Program Execution

Created comprehensive ADR for extracting and analyzing causal/process graphs from OpenTelemetry traces.

**Key Components:**
1. **Trace ETL Pipeline** - Convert OTEL spans to XES event logs for PM4Py
2. **Process Discovery** - DFG and Petri net discovery using Alpha/Inductive miners
3. **Causal Discovery** - PC algorithm, Granger causality for root cause analysis
4. **Conformance Checking** - Token replay to compare actual vs expected behavior
5. **Web UI Integration** - D3.js visualization of call graphs and DFGs

**Graph Types:**
| Type | Use Case |
|------|----------|
| Call Graph | Debugging, profiling |
| Directly-Follows Graph | Process discovery |
| Petri Net | Formal process model |
| Causal DAG | Root cause analysis |

### ADR 005: Development Process Graph Learning from Summary+Git

Created ADR for mining the software development process itself from session summaries and git history.

**Data Sources:**
- Session summary files (`Summary/summary*.md`) → session events, tasks, objectives
- Git history → commits, file changes, branches
- GitHub PRs (optional) → reviews, merges

**Key Components:**
1. **Summary Parser** - Regex/markdown parsing to extract structured events
2. **Git Parser** - `git log` parsing for commit/file events
3. **Event Correlator** - Link commits to sessions by date and SHA reference
4. **Process Mining** - Same PM4Py techniques as runtime traces
5. **Pattern Analysis** - Hotspot files, common sequences, outcome correlation

**Use Cases:**
- Discover actual development workflow vs intended
- Find file hotspots that correlate with bugs
- Identify patterns that lead to successful outcomes
- Meta-learning: improve the development process itself

---

## Discussion Notes

### Causal Graphs from OpenTelemetry

- OTEL spans naturally encode causal structure (parent → child)
- `trace_id` links all spans in a request flow
- Can build: call graphs, dependency graphs, causal DAGs
- Connects to RL triplets from ADR 003 via `sequence_id`

### Unified Approach

Both ADRs use the same underlying techniques:
- Event log extraction (XES format)
- PM4Py for process discovery
- Causal discovery algorithms (PC, FCI, Granger)
- D3.js for visualization

This creates a unified observability story:
```
Runtime Traces (OTEL) ──┐
                        ├──→ Process Mining ──→ Insights
Development Events ─────┘
```

---

## Open Questions (Deferred)

1. **Property-Based Testing**: Deferred to future session
2. **Implementation Priority**: Which ADR to implement first?
3. **Agent Lightning Integration**: How to feed learned graphs to RL?

---

## Files Created/Modified

| File | Change |
|------|--------|
| `Summary/summary20251204.1.md` | Session summary |
| `design/ADR_004_process_graph_learning_from_execution.md` | New ADR |
| `design/ADR_005_development_process_graph_learning.md` | New ADR |

---

## Next Steps

### From ADR 004 (Runtime)
- [ ] Add PM4Py dependency
- [ ] Create trace ETL pipeline
- [ ] Implement DFG discovery
- [ ] Add process graph page to Web UI

### From ADR 005 (Development)
- [ ] Create summary file parser
- [ ] Create git history parser
- [ ] Implement event correlator
- [ ] Run initial process discovery on existing summaries

---

## Status
Complete - Created ADR 004 and ADR 005
