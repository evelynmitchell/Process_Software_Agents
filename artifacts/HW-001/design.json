{
  "task_id": "HW-001",
  "api_contracts": [
    {
      "endpoint": "/hello",
      "method": "GET",
      "description": "Greet user with optional name parameter. Returns personalized greeting if name provided, otherwise returns generic greeting to World",
      "request_schema": null,
      "request_params": {
        "name": "string (optional, max_length=100, alphanumeric and spaces only)"
      },
      "response_schema": {
        "message": "string (greeting message in format 'Hello, {name}!')"
      },
      "error_responses": [
        {
          "status": 400,
          "code": "INVALID_INPUT",
          "message": "Invalid name parameter: contains invalid characters or exceeds maximum length"
        },
        {
          "status": 429,
          "code": "RATE_LIMIT_EXCEEDED",
          "message": "Too many requests. Maximum 30 requests per minute allowed"
        },
        {
          "status": 500,
          "code": "INTERNAL_SERVER_ERROR",
          "message": "Internal server error occurred while processing request"
        }
      ],
      "authentication_required": false,
      "rate_limit": "30 requests per minute per IP address"
    },
    {
      "endpoint": "/health",
      "method": "GET",
      "description": "Health check endpoint returning current system status and server timestamp for monitoring and availability verification",
      "request_schema": null,
      "request_params": null,
      "response_schema": {
        "status": "string (value: 'ok' indicating healthy state)",
        "timestamp": "string (ISO 8601 UTC datetime format)"
      },
      "error_responses": [
        {
          "status": 429,
          "code": "RATE_LIMIT_EXCEEDED",
          "message": "Too many requests. Maximum 60 requests per minute allowed"
        },
        {
          "status": 500,
          "code": "INTERNAL_SERVER_ERROR",
          "message": "Internal server error occurred while processing request"
        }
      ],
      "authentication_required": false,
      "rate_limit": "60 requests per minute per IP address"
    }
  ],
  "data_schemas": [],
  "component_logic": [
    {
      "component_name": "FastAPIApplicationFactory",
      "semantic_unit_id": "SU-001",
      "responsibility": "Initialize and configure FastAPI application instance with middleware, exception handlers, and startup configuration",
      "interfaces": [
        {
          "method": "create_app",
          "parameters": {},
          "returns": "FastAPI",
          "description": "Create and return configured FastAPI application instance with all middleware and handlers registered"
        }
      ],
      "dependencies": [],
      "implementation_notes": "Create FastAPI app instance with title 'Hello World API' and version '1.0.0'. Register global exception handler middleware. Do NOT directly depend on endpoint handlers - handlers will be registered via route decorators in separate modules. ADDRESSES ISSUE-005: Removed direct dependencies on endpoint handlers to prevent circular dependencies.",
      "complexity": 11
    },
    {
      "component_name": "HelloEndpointHandler",
      "semantic_unit_id": "SU-002",
      "responsibility": "Handle GET /hello requests with optional name parameter and return personalized greeting message",
      "interfaces": [
        {
          "method": "hello",
          "parameters": {
            "name": "Optional[str]"
          },
          "returns": "dict",
          "description": "Process hello request with optional name and return greeting message. If name provided, return 'Hello, {name}!', otherwise return 'Hello, World!'"
        }
      ],
      "dependencies": [
        "InputValidator"
      ],
      "implementation_notes": "Validate name parameter using InputValidator before processing. Name must be alphanumeric with spaces only, max 100 characters. Return JSON with 'message' key (snake_case per ADDRESSES ISSUE-007). Use @app.get('/hello') decorator to register route. ADDRESSES ISSUE-005: Removed FastAPIApplicationFactory dependency - handler registers itself via decorator. ADDRESSES ISSUE-009: Explicitly document that omitting name parameter returns 'Hello, World!' greeting.",
      "complexity": 24
    },
    {
      "component_name": "HealthEndpointHandler",
      "semantic_unit_id": "SU-003",
      "responsibility": "Handle GET /health requests and return system health status with current server timestamp",
      "interfaces": [
        {
          "method": "health",
          "parameters": {},
          "returns": "dict",
          "description": "Return health check response with status 'ok' and current UTC timestamp in ISO 8601 format"
        }
      ],
      "dependencies": [],
      "implementation_notes": "Generate current UTC timestamp using datetime.now(datetime.UTC).isoformat() to comply with Python 3.12+ standards (ADDRESSES ISSUE-008: Replaced deprecated utcnow() with datetime.now(datetime.UTC)). Return JSON with 'status' and 'timestamp' keys in snake_case (ADDRESSES ISSUE-007). Use @app.get('/health') decorator to register route. ADDRESSES ISSUE-005: Removed FastAPIApplicationFactory dependency - handler registers itself via decorator.",
      "complexity": 21
    },
    {
      "component_name": "GlobalErrorHandler",
      "semantic_unit_id": "SU-004",
      "responsibility": "Centralized exception handling for all unhandled exceptions with consistent error response formatting",
      "interfaces": [
        {
          "method": "format_error_response",
          "parameters": {
            "status_code": "int",
            "code": "str",
            "message": "str"
          },
          "returns": "dict",
          "description": "Format error response with consistent structure containing status_code, code, and message fields"
        },
        {
          "method": "handle_exception",
          "parameters": {
            "request": "Request",
            "exc": "Exception"
          },
          "returns": "JSONResponse",
          "description": "Handle unexpected exceptions and return formatted error response with appropriate HTTP status code"
        }
      ],
      "dependencies": [],
      "implementation_notes": "Register as global exception handler using @app.exception_handler(Exception). Format all error responses with 'code' field (not 'error_code') to match api_contracts specification (ADDRESSES ISSUE-003). Handle generic Exception type with 500 status code. Return JSON with consistent structure: {code: string, message: string}. ADDRESSES ISSUE-010: Simplified complexity by using single generic Exception handler rather than multiple specific exception types.",
      "complexity": 15
    },
    {
      "component_name": "InputValidator",
      "semantic_unit_id": "SU-005",
      "responsibility": "Validate query parameters and request input according to API specifications and constraints",
      "interfaces": [
        {
          "method": "validate_name_parameter",
          "parameters": {
            "name": "Optional[str]"
          },
          "returns": "Optional[str]",
          "description": "Validate optional name parameter: must be alphanumeric with spaces only, max 100 characters. Raise ValueError if invalid."
        }
      ],
      "dependencies": [],
      "implementation_notes": "Use regex pattern '^[a-zA-Z0-9 ]{1,100}$' to validate name parameter. Raise ValueError with descriptive message for invalid input. Called by HelloEndpointHandler before processing. ADDRESSES ISSUE-004: Separated validation logic into dedicated component to reduce ApplicationConfiguration coupling. ADDRESSES ISSUE-005: Removed circular dependency risk by eliminating ApplicationConfiguration orchestration of handlers.",
      "complexity": 12
    },
    {
      "component_name": "RateLimitMiddleware",
      "semantic_unit_id": "SU-005",
      "responsibility": "Enforce rate limiting on protected endpoints to prevent abuse and denial of service attacks",
      "interfaces": [
        {
          "method": "configure_rate_limiting",
          "parameters": {
            "app": "FastAPI",
            "endpoint_limits": "dict"
          },
          "returns": "None",
          "description": "Configure rate limiting middleware for specified endpoints with per-IP request limits"
        }
      ],
      "dependencies": [],
      "implementation_notes": "Use slowapi library for rate limiting implementation. Configure /hello endpoint with 30 requests per minute per IP (ADDRESSES ISSUE-001). Configure /health endpoint with 60 requests per minute per IP (ADDRESSES ISSUE-002). Return 429 status code with 'RATE_LIMIT_EXCEEDED' code when limit exceeded. Register middleware during app initialization in FastAPIApplicationFactory.",
      "complexity": 18
    }
  ],
  "design_review_checklist": [
    {
      "category": "Security",
      "description": "Verify rate limiting is configured on all public endpoints",
      "validation_criteria": "/hello endpoint has 30 req/min limit and /health has 60 req/min limit in api_contracts and RateLimitMiddleware component",
      "severity": "Critical"
    },
    {
      "category": "Security",
      "description": "Verify input validation prevents injection attacks and malformed input",
      "validation_criteria": "InputValidator component validates name parameter with regex pattern and max length constraint",
      "severity": "High"
    },
    {
      "category": "API Design",
      "description": "Verify error response format is consistent across all endpoints",
      "validation_criteria": "All error_responses in api_contracts use 'code' field (not 'error_code') matching GlobalErrorHandler.format_error_response implementation",
      "severity": "High"
    },
    {
      "category": "Architecture",
      "description": "Verify no circular dependencies exist between components",
      "validation_criteria": "FastAPIApplicationFactory has zero dependencies, endpoint handlers do not depend on ApplicationConfiguration, no bidirectional dependencies",
      "severity": "High"
    },
    {
      "category": "Architecture",
      "description": "Verify component coupling is minimized and single responsibility maintained",
      "validation_criteria": "No component has more than 2 dependencies, each component has single clear responsibility, ApplicationConfiguration removed from design",
      "severity": "High"
    },
    {
      "category": "Code Quality",
      "description": "Verify Python 3.12 compatibility for datetime operations",
      "validation_criteria": "HealthEndpointHandler uses datetime.now(datetime.UTC).isoformat() instead of deprecated utcnow()",
      "severity": "High"
    },
    {
      "category": "API Design",
      "description": "Verify consistent naming conventions in JSON responses",
      "validation_criteria": "All response keys use snake_case consistently: 'message', 'status', 'timestamp', 'code'",
      "severity": "Medium"
    },
    {
      "category": "Documentation",
      "description": "Verify API contracts are self-documenting for optional parameters",
      "validation_criteria": "/hello endpoint description explicitly states behavior when name parameter is omitted",
      "severity": "Medium"
    },
    {
      "category": "Error Handling",
      "description": "Verify all endpoints have complete error response definitions",
      "validation_criteria": "Both /hello and /health endpoints define 400, 429, and 500 error responses with code and message fields",
      "severity": "Medium"
    },
    {
      "category": "Performance",
      "description": "Verify component complexity is reasonable and maintainable",
      "validation_criteria": "GlobalErrorHandler complexity reduced to 15, no component exceeds complexity 24, all components have clear single responsibility",
      "severity": "Medium"
    }
  ],
  "architecture_overview": "FastAPI-based REST API with two public endpoints (/hello and /health) featuring global error handling middleware, input validation, and rate limiting protection. The architecture separates concerns into endpoint handlers, application factory, and error handling components with minimal coupling.",
  "technology_stack": {
    "language": "Python 3.12",
    "framework": "FastAPI 0.104+",
    "server": "Uvicorn 0.24+",
    "validation": "Pydantic 2.0+"
  },
  "assumptions": [
    "FastAPI 0.104 or higher is available with Pydantic 2.0+ for validation",
    "Uvicorn 0.24+ will be used as ASGI server",
    "slowapi library will be available for rate limiting implementation",
    "System will handle less than 100 concurrent requests initially",
    "Rate limiting will be enforced per IP address using X-Forwarded-For header when behind proxy",
    "All timestamps will be in UTC timezone for consistency",
    "Input validation regex pattern is sufficient for security requirements (no SQL/NoSQL injection risk as no database is used)"
  ],
  "timestamp": "2025-12-15T15:11:47.467628"
}