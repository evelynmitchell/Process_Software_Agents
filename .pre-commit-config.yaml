# Pre-commit hooks configuration
# Install with: uv pip install pre-commit && uv run pre-commit install
# Run manually: uv run pre-commit run --all-files

# Global excludes - artifacts and contrib contain generated/external code
exclude: ^(artifacts/|contrib/)

repos:
  # Black - Python code formatter
  - repo: https://github.com/psf/black
    rev: 24.10.0
    hooks:
      - id: black
        language_version: python3.12
        args: ['--config=pyproject.toml']

  # isort - Python import sorter
  - repo: https://github.com/pycqa/isort
    rev: 5.13.2
    hooks:
      - id: isort
        args: ['--settings-path=pyproject.toml']

  # Ruff - Fast Python linter
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.8.1
    hooks:
      - id: ruff
        args: ['--fix', '--config=pyproject.toml']

  # Pylint - Python static code analyzer
  # Note: Runs in isolated env, so we disable import-error (E0401) and
  # import-outside-toplevel (C0415) since those need the full project deps
  - repo: https://github.com/pylint-dev/pylint
    rev: v3.3.2
    hooks:
      - id: pylint
        exclude: ^(examples/|scripts/)  # Examples/scripts have known style issues
        args:
          - '--rcfile=.pylintrc'
          - '--disable=C0103,C0114,C0115,C0116,C0201,C0301,C0302,C0411,C0413,C0415,C1803,E0110,E0401,E0602,E0611,E0633,E1101,E1120,R0402,R0801,R0902,R0911,R0912,R0913,R0914,R0915,R0917,R1705,R1723,W0105,W0107,W0201,W0212,W0237,W0246,W0401,W0404,W0406,W0603,W0611,W0612,W0613,W0614,W0621,W0622,W0707,W0718,W1203,W1510,W1514,W2301'
          - '--max-line-length=88'
        additional_dependencies:
          - fastapi
          - uvicorn
          - sqlalchemy
          - pydantic
          - httpx
          - structlog
          - rich
          - anthropic
          - tenacity
          - python-fasthtml
          - pytest

  # Zizmor - GitHub Actions security linter
  - repo: https://github.com/zizmorcore/zizmor-pre-commit
    rev: v1.18.0
    hooks:
      - id: zizmor

  # ty - Astral's Python type checker (extremely fast, written in Rust)
  # No official pre-commit repo yet (https://github.com/astral-sh/ty/issues/269)
  # Using local hook until official release
  # Non-blocking (informational) during alpha - remove "|| true" when ready to enforce
  - repo: local
    hooks:
      - id: ty
        name: ty (type checker - informational)
        entry: bash -c 'uv run ty check || true'
        language: system
        types: [python]
        pass_filenames: false
        verbose: true

  # Additional useful hooks
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v5.0.0
    hooks:
      - id: trailing-whitespace
      - id: end-of-file-fixer
      - id: check-yaml
        exclude: mkdocs.yml  # Uses Python-specific YAML tags
      - id: check-added-large-files
      - id: check-merge-conflict
      - id: debug-statements
